import xbmc,xbmcaddon,xbmcgui,xbmcplugin,urllib,urllib2,os,re,sys,datetime,hashlib,timeimport base64import HTMLParserimport osfrom resources.libs.modules import satoolsaddon_id        = 'plugin.video.streamarmy'AddonTitle      = "[COLOR red][B]STREAM ARMY[/B][/COLOR]"fanart          = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))fanarts         = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))icon            = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id, 'icon.png'))dialog          = xbmcgui.Dialog()dp              = xbmcgui.DialogProgress()def SCRAPE_AUDIOBOOKS_CATS():     url="http://www.loyalbooks.com/genre-menu"    link=satools.open_url(url)    match=re.compile('<td class="link menu">(.+?)</a>',re.DOTALL).findall(link)    for item in match:        if "paid" not in item:            link1=re.compile('<a href="(.+?)"',re.DOTALL).findall(item)[0]            link2="http://www.loyalbooks.com" + link1            name=re.compile('id="(.+?)"',re.DOTALL).findall(item)[0]            icon = 'http://i.imgur.com/joPzR60.png'            satools.addDir("[COLOR silver]" + name + "[/COLOR]",link2,60,icon,fanarts,'')            def SCRAPE_AUDIOBOOKS_CONTENT(url):    link=satools.open_url(url)    match=re.compile('</table><br>(.+?)data-ad-format="horizontal',re.DOTALL).findall(link)[0]    match2=re.compile('<td(.+?)</td>',re.DOTALL).findall(match)    for item in match2:        url1 = re.compile('<a href="(.+?)">',re.DOTALL).findall(item)[0]        link2 = "http://www.loyalbooks.com" + url1        icon = re.compile('src="(.+?)"',re.DOTALL).findall(item)[0]        iconimage = "http://www.loyalbooks.com" + icon        name = re.compile('alt="(.+?)"',re.DOTALL).findall(item)[0]        satools.addDir("[COLOR silver]" + name + "[/COLOR]",link2,61,iconimage,fanarts,'')    try:        link=satools.open_url(url)        nextpage=re.compile('<link rel="next" href="(.+?)">',re.DOTALL).findall(link)[0]        icon = 'http://i.imgur.com/B4r7zDm.png'        satools.addDir("[COLOR red]Next Page -->[/COLOR]",nextpage,60,icon,fanarts,'')    except: pass    def SCRAPE_AUDIOBOOKS_LINKS(name,url,iconimage):    link=satools.open_url(url)    match=re.compile('{name:(.+?)}',re.DOTALL).findall(link)    for item in match:        title = re.compile('"(.+?)"',re.DOTALL).findall(item)[0]        url1 = re.compile('mp3:"(.+?)"',re.DOTALL).findall(item)[0]        satools.addLink("[COLOR silver]" + title + "[/COLOR]",url1,7,iconimage,fanarts,'')