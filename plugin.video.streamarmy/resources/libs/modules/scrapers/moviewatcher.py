import xbmc,xbmcaddon,xbmcgui,xbmcplugin,urllib,urllib2,os,re,sys,datetime,hashlibimport base64import HTMLParserimport osfrom resources.libs.modules import satoolsaddon_id        = 'plugin.video.streamarmy'AddonTitle      = "[COLOR red][B]STREAM ARMY[/B][/COLOR]"fanart          = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))fanarts         = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))icon            = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id, 'icon.png'))dialog          = xbmcgui.Dialog()dp              = xbmcgui.DialogProgress()def SCRAPE_MOVIEWATCHERS_CONTENT(url):        issearch = 0    try:        url,term = url.split("|SPLIT|")        issearch = 1    except: pass        namelist     = []    urllist      = []    iconlist     = []    fanartlist   = []    combinedlist = []        url_check = url    link = satools.open_url(url)    match = re.compile('<div class="movie-item view-tenth">(.+?)<div class="one_movie-item">').findall(link)    dialog.ok("IM HERE", str (match))    for links in match:        link1 = re.compile ('<a href="(.+?)"').findall(links)[0]        img = re.compile ('<img src="(.+?)"').findall(links)[0]        title = re.compile ('alt="(.+?)"').findall(links)[0]        imdb = re.compile ('<div class="movie-quality">(.+?)</div>').findall(links)[0]        if not 'http' in link1:            link2 = 'http://moviewatcher.io' + link1        if not 'http' in img:            img1 = 'http://moviewatcher.io' + img            namelist.append(title)            urllist.append(link2)            iconlist.append(img1)            combinedlist = list(zip(namelist,urllist,iconlist))    for title,link2,img1 in combinedlist:            if issearch == 0:             satools.addDir("[COLOR silver]" + title + "[/COLOR]" + "[COLOR yellow]" + " " + imdb + "[/COLOR]",link2,37,img1,fanart,'')        else:            if ' ' in term:                notfound = 0                checks = term.split(" ")                for check in checks:                    if not check.lower() in title.lower():                        notfound = 1                if notfound == 0:                     satools.addDir("[COLOR silver]" + title + "[/COLOR]" + "[COLOR yellow]" + " " + imdb + "[/COLOR]",link2,37,img1,fanart,'')            else:                if term.lower() in title.lower():                     satools.addDir("[COLOR silver]" + title + "[/COLOR]" + "[COLOR yellow]" + " " + imdb + "[/COLOR]",link2,37,img1,fanart,'')                     def SCRAPE_MOVIEWATCHERS_LINKS(url):    gotcha = []      link = satools.open_url(url)    match = re.compile('<div class="full-torrent1 full-torrent1-title">(.+?)<div class="related">').findall(link)[0]    grab = re.compile ('<a class="full-torrent1" rel="nofollow">(.+?)</span>').findall(match)    for links in grab:        link1 = re.compile ("'(.+?)'").findall(links)[0]        title = re.compile ('<div class="small_server">(.+?)</div>').findall(links)[0].replace ('Stream server: ', '')           if 'openload' in title:            try:                link2 = 'http://moviewatcher.io' + link1                if not 'http' in link1:                    link3 = satools.open_url(link2)                    grab1 = re.compile ('<div class="share-icons">(.+?)</div>',re.DOTALL).findall(link3)[0]                    playme = re.compile ('<a href="(.+?)"').findall(grab1)[0].replace('http://www.twitter.com/share?url=', '')                    gotcha.append(playme)            except:pass               elif 'watchers' in title:            try:                link2 = 'http://moviewatcher.io' + link1                if not 'http' in link1:                    link3 = satools.open_url(link2)                    grab2 = re.compile('<textarea class="form-control" cols=24 rows=3>(.+?)</textarea>').findall(link3)[0]                    gotcha.append(grab2)            except:pass            elif 'thevideo.me' in title:            try:                link2 = 'http://moviewatcher.io' + link1                if not 'http' in link1:                    link3 = satools.open_url(link2)                    grab3 = re.compile('<meta property="og:url" content="(.+?)"/>').findall(link3)[0]                    gotcha.append(grab3)            except: pass        elif 'vidlox' in title:            try:                link2 = 'http://moviewatcher.io' + link1                if not 'http' in link1:                    link3 = satools.open_url(link2)                    grab5 = re.compile('name="dl_link">(.+?)</textarea>').findall(link3)[0]                    gotcha.append(grab5)            except: pass        elif 'streamin.to' in title:            try:                link2 = 'http://moviewatcher.io' + link1                if not 'http' in link1:                    link3 = satools.open_url(link2)                    grab6 = re.compile("action='(.+?)'").findall(link3)[0]                    gotcha.append(grab6)            except: pass        elif 'vidup' in title:            try:                link2 = 'http://moviewatcher.io' + link1                if not 'http' in link1:                    link3 = satools.open_url(link2)                    grab7 = re.compile('<meta property="og:url" content="(.+?)"/>').findall(link3)[0]                    gotcha.append(grab7)            except: pass        elif 'watchvideo.us' in title:            try:                link2 = 'http://moviewatcher.io' + link1                if not 'http' in link1:                    link3 = satools.open_url(link2)                    grab8 = re.compile('rows=3>(.+?)</textarea>').findall(link3)[0]                    gotcha.append(grab8)            except: pass    title = title.capitalize()    for links in gotcha:        satools.addLink("[COLOR silver]" + title + "[/COLOR]",links,2,icon,fanart,'')