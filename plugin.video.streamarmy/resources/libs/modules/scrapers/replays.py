import xbmc,xbmcaddon,xbmcgui,xbmcplugin,urllib,urllib2,os,re,sys,datetime,hashlib,timeimport base64import HTMLParserimport osfrom resources.libs.modules import satoolsaddon_id        = 'plugin.video.streamarmy'AddonTitle      = "[COLOR red][B]STREAM ARMY[/B][/COLOR]"fanart          = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))fanarts         = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))icon            = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id, 'icon.png'))dialog          = xbmcgui.Dialog()dp              = xbmcgui.DialogProgress()    def SCRAPE_FULLHIGH(url):        link = satools.open_url(url)    match = re.compile('<div class="cover">(.+?)</div>').findall(link)    for links in match:        url = re.compile ('<a href="(.+?)"').findall(links)[0]        title = re.compile ('title="(.+?)"').findall(links)[0]        icon = re.compile ('src="(.+?)"').findall(links)[0]        #if 'premier-league' in url:        satools.addDir(title,url,50,icon,fanarts,'')                try:        nextpage = re.compile ('rel="next" href="(.+?)">').findall(link)[0]        icon = 'http://i.imgur.com/B4r7zDm.png'        satools.addDir("[COLOR red]" + "Next Page" + "[/COLOR]",nextpage,49,icon,fanarts,'')    except:pass    def SCRAPE_FULLHIGH_GET(url,iconimage,fanart):    link = satools.open_url(url)    match = re.compile ('<p style="text-align:center"><iframe(.+?)</p>').findall(link)        for links in match:        url = re.compile ('src="(.+?)"',re.DOTALL).findall(links)[0]        url1 = str.lower(url)        if '1e' in url1:            title = '1st Half'        else:            title = '2nd Half'                satools.addLink(title,url,51,icon,fanart,'')        def SCRAPE_FULLHIGH_PLAY(url,name,iconimage):    dp.create(AddonTitle,"[COLOR yellow]Generating link...[/COLOR]",'[COLOR red]Please wait...[/COLOR]','')       dp.update(0)    time.sleep(2)    import urlresolver        if urlresolver.HostedMediaFile(url).valid_url():         stream_url = urlresolver.HostedMediaFile(url).resolve()        liz = xbmcgui.ListItem(name,iconImage=icon, thumbnailImage=icon)        liz.setPath(stream_url)        dp.close()        xbmc.Player ().play(stream_url, liz, False)        quit()    else:        stream_url=url        liz = xbmcgui.ListItem(name,iconImage=icon, thumbnailImage=icon)        liz.setPath(stream_url)        dp.close()        xbmc.Player ().play(stream_url, liz, False)        quit()    