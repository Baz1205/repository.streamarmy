import xbmc,xbmcaddon,xbmcgui,xbmcplugin,urllib,urllib2,os,re,sys,datetime,hashlib,timeimport base64import HTMLParserimport osfrom resources.libs.modules import satoolsaddon_id        = 'plugin.video.streamarmy'AddonTitle      = "[COLOR red][B]STREAM ARMY[/B][/COLOR]"fanart          = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))fanarts         = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))icon            = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id, 'icon.png'))dialog          = xbmcgui.Dialog()dp              = xbmcgui.DialogProgress()def SCRAPE_TVBOX_CATS(url):    link = satools.open_url(url)    icon1 = re.compile ('<div style="float: left;">(.+?)<br/>').findall(link)[0]    icon2 = re.compile ('<img src="(.+?)"').findall(icon1)[0]    iconimage = 'https:' + icon2    match = re.compile ('<h4>All Seasons</h4>(.+?)</article>').findall(link)[0]    grab = re.compile ('<a href="(.+?)">(.+?)</a>').findall(match)    for link,title in grab:        url = 'https://tvbox.ag' + link        satools.addDir("[COLOR silver]" + title + "[/COLOR]",url,85,iconimage,fanart,'')        def SCRAPE_TVBOX_LINKS(url,iconimage):    link = satools.open_url(url)    match = re.compile ('<table class="show_episodes">(.+?)</table>').findall(link)[0]    grab = re.compile ('<td>(.+?)</td>.+?<a href="(.+?)">(.+?)</a>.+?<td>(.+?)</td>').findall(match)    for epi,url1,title,amount in grab:        url = 'https://tvbox.ag' + url1        satools.addDir("[COLOR silver]" +epi+ "  "  + title + "  " +amount+ "[/COLOR]",url,86,iconimage,fanart,'')        def SCRAPE_TVBOX_PLAY(url,iconimage):    link = satools.open_url(url)    match = re.compile ('<table class="show_links">(.+?)</table>').findall(link)[0]    grab = re.compile ('<td class="show_links_link"(.+?)>Report</a>').findall(match)    for links in grab:        title = re.compile ('>(.+?)</td>').findall(links)[0]        title = title.title()        sep = '.'        title = title.split(sep, 1)[0]        url = re.compile ("onclick=\"report\('(.+?)'").findall(links)[0]        satools.addLink("[COLOR silver]" +title+ "[/COLOR]",url,2,iconimage,fanart,'')