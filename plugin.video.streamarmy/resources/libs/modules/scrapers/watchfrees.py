import xbmc,xbmcaddon,xbmcgui,xbmcplugin,urllib,urllib2,os,re,sys,datetime,hashlib,timeimport base64import HTMLParserimport osfrom resources.libs.modules import satoolsaddon_id        = 'plugin.video.streamarmy'AddonTitle      = "[COLOR red][B]STREAM ARMY[/B][/COLOR]"fanart          = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))fanarts         = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))icon            = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id, 'icon.png'))dialog          = xbmcgui.Dialog()dp              = xbmcgui.DialogProgress()def SCRAPE_WATCHFREES(url):    link = satools.open_url(url)    match = re.compile ('<figure>(.+?)</figure>').findall(link)    for links in match:        url1 = re.compile ('<a href="(.+?)">').findall(links)[0]        url = 'https://watchfrees.com' + url1        title = re.compile ('<h3>(.+?)</h3>').findall(links)[0]        quality = re.compile ('<div class="quanlity">(.+?)</div>').findall(links)[0]        icon1 = re.compile ('src="(.+?)"').findall(links)[0]        icon = 'https:' + icon1        satools.addDir("[COLOR silver]" + title + "  " + quality + "[/COLOR]",url,37,icon,fanart,'')            try:        np = re.compile ('<li  class=selected><a href=\'.+?\' data-page=\'.+?\'>.+?</a></li><li ><a href=\'(.+?)\'').findall(link)[0]        nextpage1 = re.compile ('<link rel="canonical" href="(.+?)"/>').findall(link)[0]        nextpage = 'https://watchfrees.com' + nextpage1 + np        icon = 'http://i.imgur.com/B4r7zDm.png'        satools.addDir("[COLOR red]Next Page -->[/COLOR]",nextpage,40,icon,fanart,'')    except:pass                def SCRAPE_WATCHFREES_PLAY(url,iconimage):    link = satools.open_url(url)    match = re.compile ('<iframe allowfullscreen="true"(.+?)</iframe').findall(link)[0]    grab = re.compile ('src="(.+?)"').findall(match)[0]    url1 = 'https:' + grab    link2 = satools.open_url(url1)    match2 = re.compile ('<script type="text/JavaScript">(.+?)</script>').findall(link2)[0]    grab = re.compile ('{(.+?)}').findall(match2)    for links in grab:        try:            url = re.compile ('\'(.+?)\'').findall(links)[0]            title = re.compile ('label: \'(.+?)\'').findall(links)[0]            if not 'Auto' in title:                satools.addLink("[COLOR silver]" + title +"[/COLOR]",url,38,icon,fanart,'')        except:pass        def SCRAPE_WATCHFREES_PLAY_LINK(url):    dp.create(AddonTitle,"[COLOR yellow]Generating link...[/COLOR]",'[COLOR red]Please wait...[/COLOR]','')       dp.update(0)    time.sleep(1)    xbmc.Player().play(url)    quit()    def SCRAPE_GENRES():    url = 'https://watchfrees.com/'    link = satools.open_url(url)    match = re.compile ('<ul class="sub-menu w1">(.+?)</ul>').findall(link)[0]    grab = re.compile ('<a href="(.+?)">(.+?)</a>').findall(match)    for url1,title in grab:        url = 'https://watchfrees.com' + url1        if 'TV Show' not in title:            satools.addDir("[COLOR silver]" + title +"[/COLOR]",url,40,icon,fanart,'')            def SCRAPE_YEARS():    url = 'https://watchfrees.com/'    link = satools.open_url(url)    match = re.compile ('<ul class="sub-menu w3">(.+?)</ul>').findall(link)[0]    grab = re.compile ('<a href="(.+?)">(.+?)</a>').findall(match)    for url1,title in grab:        url = 'https://watchfrees.com' + url1        satools.addDir("[COLOR silver]" + title +"[/COLOR]",url,40,icon,fanart,'')                