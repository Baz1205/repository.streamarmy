import xbmc,xbmcaddon,xbmcgui,xbmcplugin,urllib,urllib2,os,re,sys,datetime,hashlibimport base64import HTMLParserimport osfrom resources.libs.modules import satoolsaddon_id        = 'plugin.video.streamarmy'AddonTitle      = "[COLOR red][B]STREAM ARMY[/B][/COLOR]"fanart          = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))fanarts         = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id , 'fanart.jpg'))icon            = xbmc.translatePath(os.path.join('special://home/addons/' + addon_id, 'icon.png'))dialog          = xbmcgui.Dialog()dp              = xbmcgui.DialogProgress()                def SCRAPE_PORNHD_CATS():        url = 'http://www.pornhd.com/category'    link = satools.open_url(url).replace('&amp;', 'and')    match = re.compile('<ul class="tag-150-list">(.+?)<div class="footer-zone">',re.DOTALL).findall(link)    match2 = re.compile ('<li class="category">(.+?)</span>',re.DOTALL).findall(link)        for links in match2:        image = re.compile('data-original="(.+?)"').findall(links)[0]        name = re.compile ('alt="(.+?)"').findall(links)[0]        cat = re.compile('<a href="(.+?)">',re.DOTALL).findall(links)[0]        if not 'http' in cat:            link2 = 'http://www.pornhd.com' + cat            satools.addDir("[COLOR silver]" + name + "[/COLOR]",link2,66,image,fanart,'')            def SCRAPE_PORNHD_CONTENT(url):    url_for_next = url    nextpage = 0    try:        a,url = url.split('|')            except: nextpage = 1    result = satools.open_url(url)        match = re.compile('<section id="pageContent"(.+?)<div class="pager paging">',re.DOTALL).findall(result)    match2 = re.compile ('<a class="thumb"(.+?)<span class="add-to">',re.DOTALL).findall(result)        for links in match2:        try:            title = re.compile('<img alt="(.+?)"',re.DOTALL).findall(links)[0]                                    length = re.compile('<time>(.+?)</time>',re.DOTALL).findall(links)[0]                        iconimage=re.compile('src="(.+?)"').findall(links)[0]                        if not "http" in iconimage:                iconimage=re.compile('data-original="(.+?)"').findall(links)[0]                                            link = re.compile('href="(.+?)"',re.DOTALL).findall(links)[0]            if not 'http' in link:                link2 = 'http://www.pornhd.com' + link                satools.addDir("[COLOR silver]" + title + "[/COLOR]" "[COLOR red]"  " :: Video Length :: " + length + "[/COLOR]" ,link2,67,iconimage,fanart,'')        except: pass                    if nextpage == 1:        try:            next_url = ""            if not "=" in url_for_next:                url_for_next = url_for_next + "?page=1"                a,b = url_for_next.split("=")                c = int(b) + 1                next_url = a + "=" + str(c)                satools.addDir('[COLOR red]Next Page >>[/COLOR]',next_url,66,icon,fanart)               except: pass        def SCRAPE_PORNHD_PLAY_CONTENT(name,url,iconimage,fanart):    link = satools.open_url(url)    match = re.compile('sources.+?{(.+?)}',re.DOTALL).findall(link)    a = str(match)    match = a.replace('\\','')    vid = re.compile("720.+?'.+?'(.+?)',").findall(match)[0]    liz = xbmcgui.ListItem(name, iconImage=iconimage, thumbnailImage=iconimage)        xbmc.Player ().play(vid, liz, False)        quit(0)